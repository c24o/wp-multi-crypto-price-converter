{"version":3,"file":"blocks/converter/view.js","mappings":"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","sources":["webpack://multi-crypto-price-converter/./src/blocks/converter/FrontendConverter.tsx","webpack://multi-crypto-price-converter/external window [\"wp\",\"element\"]","webpack://multi-crypto-price-converter/external window [\"wp\",\"i18n\"]","webpack://multi-crypto-price-converter/external window \"React\"","webpack://multi-crypto-price-converter/external window \"ReactJSXRuntime\"","webpack://multi-crypto-price-converter/webpack/bootstrap","webpack://multi-crypto-price-converter/webpack/runtime/compat get default export","webpack://multi-crypto-price-converter/webpack/runtime/define property getters","webpack://multi-crypto-price-converter/webpack/runtime/hasOwnProperty shorthand","webpack://multi-crypto-price-converter/webpack/runtime/make namespace object","webpack://multi-crypto-price-converter/./src/blocks/converter/view.tsx"],"sourcesContent":["/**\n * React component for the frontend view of the Multi Crypto Price Converter block.\n */\nimport { ReactElement, useEffect, useState } from 'react';\nimport { __ } from '@wordpress/i18n';\n\ninterface PricesMap {\n\t[key: string]: number;\n}\n\ninterface FetchPricesResponse {\n\tprices: PricesMap;\n\tnext_update?: number;\n}\n\ninterface FrontendConverterProps {\n\tcoins: string[];\n}\n\n/**\n * Fetch prices from the REST API endpoint.\n *\n * @param {string} coinsParam - Comma-separated coin symbols.\n * @param {AbortSignal} [signal] - Optional abort signal for the fetch request.\n * @return {Promise<FetchPricesResponse>} A map of coin symbols to their prices in USD and the next update timestamp.\n */\nasync function fetchPrices( coinsParam: string, signal?: AbortSignal ): Promise<FetchPricesResponse> {\n\ttry {\n\t\tconst response = await fetch( `/wp-json/mcc/v1/prices?coins=${ coinsParam }`, { signal } );\n\t\tif ( ! response.ok ) {\n\t\t\tthrow new Error( `HTTP error! status: ${ response.status }` );\n\t\t}\n\t\tconst data = await response.json();\n\t\tif ( data.success && data.data?.prices ) {\n\t\t\tconst pricesMap: PricesMap = {};\n\t\t\tdata.data.prices.forEach( ( item: { symbol: string, price_usd: string } ) => {\n\t\t\t\tpricesMap[ item.symbol ] = parseFloat( item.price_usd );\n\t\t\t} );\n\t\t\treturn { prices: pricesMap, next_update: data.data.next_update };\n\t\t}\n\t\tthrow new Error( data.message || 'Invalid API response' );\n\t} catch ( error ) {\n\t\tif ( error instanceof Error && error.name === 'AbortError' ) {\n\t\t\tthrow error;\n\t\t}\n\t\tconsole.error( 'Failed to fetch prices:', error );\n\t\treturn { prices: {}, next_update: 0 };\n\t}\n}\n\n/**\n * Format the converted amount to display it.\n *\n * @param {string} coin - The coin to display.\n * @param {number} amount - The amount to format.\n * @return {string} The amount formatted to 8 decimal places.\n */\nfunction formatConvertedAmount( coin: string, amount: number ): string {\n\tif ( ! amount || ! coin ) return '';\n\tif ( 'usd' === coin ) return amount.toFixed( 2 );\n\treturn amount.toFixed( 8 );\n}\n\n/**\n * Format a number as a USD currency string.\n *\n * @param {number} price - The price to format.\n * @return {string} The formatted price string.\n */\nfunction formatPrice( price: number ): string {\n\tif ( ! price || price === 0 ) {\n\t\treturn 'â€”';\n\t}\n\treturn new Intl.NumberFormat( 'en-US', {\n\t\tstyle: 'currency',\n\t\tcurrency: 'USD',\n\t\tminimumFractionDigits: 2,\n\t\tmaximumFractionDigits: 2,\n\t} ).format( price );\n}\n\nexport default function FrontendConverter( { coins }: FrontendConverterProps ): ReactElement {\n\tconst [ prices, setPrices ] = useState<PricesMap>( {} );\n\tconst [ baseCoin, setBaseCoin ] = useState<string>( 'usd' );\n\tconst [ baseAmount, setBaseAmount ] = useState<number | ''>( 1 );\n\tconst [ isLoading, setIsLoading ] = useState<boolean>( true );\n\tconst [ error, setError ] = useState<boolean>( false );\n\n\tuseEffect( () => {\n\t\tconst controller = new AbortController();\n\t\tconst coinsParam = coins.join( ',' );\n\t\tlet timeoutId: ReturnType<typeof setTimeout>;\n\n\t\tconst updatePrices = async () => {\n\t\t\ttry {\n\t\t\t\tconst { prices: fetchedPrices, next_update } = await fetchPrices( coinsParam, controller.signal );\n\t\t\t\t// Only update if we have data, otherwise keep old prices or show error\n\t\t\t\tif ( Object.keys( fetchedPrices ).length > 0 ) {\n\t\t\t\t\tsetPrices( fetchedPrices );\n\t\t\t\t\tsetError( false );\n\t\t\t\t} else {\n\t\t\t\t\tsetError( true );\n\t\t\t\t}\n\n\t\t\t\tif ( ! controller.signal.aborted ) {\n\t\t\t\t\tlet delay = 60000; // Default fallback delay.\n\t\t\t\t\tif ( next_update ) {\n\t\t\t\t\t\tconst nowSeconds = Date.now() / 1000;\n\t\t\t\t\t\tconst diff = next_update - nowSeconds;\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * If the scheduled time is in the future, wait for it.\n\t\t\t\t\t\t * If it's in the past (or very close), wait at least 5\n\t\t\t\t\t\t * seconds to avoid tight loops.\n\t\t\t\t\t\t */\n\t\t\t\t\t\tdelay = diff > 0 ? diff * 1000 : 5000;\n\t\t\t\t\t}\n\t\t\t\t\ttimeoutId = setTimeout( updatePrices, delay );\n\t\t\t\t}\n\t\t\t} catch ( err ) {\n\t\t\t\t// Ignore abort errors\n\t\t\t\tif ( err instanceof Error && err.name !== 'AbortError' ) {\n\t\t\t\t\tsetError( true );\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tif ( ! controller.signal.aborted ) {\n\t\t\t\t\tsetIsLoading( false );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t// Start the polling loop.\n\t\tupdatePrices();\n\n\t\t// Cleanup timeout and abort fetch on component unmount/update.\n\t\treturn () => {\n\t\t\tclearTimeout( timeoutId );\n\t\t\tcontroller.abort();\n\t\t};\n\t}, [ coins ] );\n\n\t/**\n\t * Calculates the display value for a specific coin based on the current base coin.\n\t *\n\t * @param {string} targetCoin - The coin to calculate for.\n\t * @return {string | number} The calculated amount or the raw input if it's the base.\n\t */\n\tconst getDisplayAmount = ( targetCoin: string ): string | number => {\n\t\tif ( baseAmount === '' || baseAmount === 0 ) return '';\n\t\tif ( targetCoin === baseCoin ) return baseAmount;\n\t\tif ( 'usd' !== baseCoin && ! prices[ baseCoin ] ) return '';\n\t\tif ( 'usd' !== targetCoin && ! prices[ targetCoin ] ) return '';\n\n\t\tconst usdValue = 'usd' === baseCoin ? baseAmount : baseAmount * prices[ baseCoin ];\n\t\tconst targetValue = 'usd' === targetCoin ? usdValue : usdValue / prices[ targetCoin ];\n\t\treturn formatConvertedAmount( targetCoin, targetValue );\n\t};\n\n\t/**\n\t * Focus the input when clicking on the row cells.\n\t *\n\t * @param {React.MouseEvent<HTMLTableRowElement>} e - The click event.\n\t */\n\tconst handleRowClick = ( e: React.MouseEvent<HTMLTableRowElement> ) => {\n\t\tif ( 'INPUT' === ( e.target as HTMLElement ).tagName ) {\n\t\t\treturn;\n\t\t}\n\t\tconst input = e.currentTarget.querySelector( 'input' );\n\t\tif ( input ) {\n\t\t\tinput.focus();\n\t\t}\n\t};\n\n\treturn (\n\t\t<figure className=\"wp-block-table is-style-stripes\">\n\t\t\t<table>\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th scope=\"col\" className=\"mcpc-converter-th-coin\">{ __( 'Coin', 'multi-crypto-price-converter' ) }</th>\n\t\t\t\t\t\t<th scope=\"col\" className=\"mcpc-converter-th-price\">{ __( 'Price (USD)', 'multi-crypto-price-converter' ) }</th>\n\t\t\t\t\t\t<th scope=\"col\" className=\"mcpc-converter-th-amount\">{ __( 'Amount', 'multi-crypto-price-converter' ) }</th>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr\n\t\t\t\t\t\tclassName={ `mcpc-converter-row${ 'usd' === baseCoin ? ' mcpc-row-active' : '' }` }\n\t\t\t\t\t\tonClick={ handleRowClick }\n\t\t\t\t\t>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t{ __( 'USD', 'multi-crypto-price-converter' ) }\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t{ formatPrice( 1.0 ) /* USD is always 1 USD */ }\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tid=\"mcpc-usd-amount\"\n\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\tclassName=\"mcpc-amount-input\"\n\t\t\t\t\t\t\t\taria-label={ __( 'Amount in USD', 'multi-crypto-price-converter' ) }\n\t\t\t\t\t\t\t\tvalue={ getDisplayAmount( 'usd' ) }\n\t\t\t\t\t\t\t\tonChange={ ( e ) => {\n\t\t\t\t\t\t\t\t\tsetBaseCoin( 'usd' );\n\t\t\t\t\t\t\t\t\tsetBaseAmount( e.target.value === '' ? '' : parseFloat( e.target.value ) );\n\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\tplaceholder=\"1.00\"\n\t\t\t\t\t\t\t\tstep=\"0.01\"\n\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t{ isLoading ? (\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colSpan={ 3 }>{ __( 'Loading prices...', 'multi-crypto-price-converter' ) }</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t) : error ? (\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td colSpan={ 3 } className=\"mcpc-error\">{ __( 'Error loading prices.', 'multi-crypto-price-converter' ) }</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t) : (\n\t\t\t\t\t\tcoins.map( ( coin ) => {\n\t\t\t\t\t\t\tconst price = prices[ coin ];\n\t\t\t\t\t\t\tconst isCurrentCoin = coin === baseCoin;\n\t\t\t\t\t\t\tconst inputId = `mcpc-amount-${ coin }`;\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<tr\n\t\t\t\t\t\t\t\t\tkey={ coin }\n\t\t\t\t\t\t\t\t\tdata-coin={ coin }\n\t\t\t\t\t\t\t\t\tclassName={ isCurrentCoin ? 'mcpc-row-active mcpc-converter-row' : 'mcpc-converter-row' }\n\t\t\t\t\t\t\t\t\tonClick={ handleRowClick }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{ coin.toUpperCase() }\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t{ formatPrice( price ) }\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\tid={ inputId }\n\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\t\t\t\t\t\taria-label={ `Amount in ${ coin.toUpperCase() }` }\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"mcpc-amount-input\"\n\t\t\t\t\t\t\t\t\t\t\tvalue={ getDisplayAmount( coin ) }\n\t\t\t\t\t\t\t\t\t\t\tonChange={ ( e ) => {\n\t\t\t\t\t\t\t\t\t\t\t\tsetBaseCoin( coin );\n\t\t\t\t\t\t\t\t\t\t\t\tsetBaseAmount( e.target.value === '' ? '' : parseFloat( e.target.value ) );\n\t\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"-\"\n\t\t\t\t\t\t\t\t\t\t\tstep=\"0.00000001\"\n\t\t\t\t\t\t\t\t\t\t\tmin=\"0\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} )\n\t\t\t\t\t) }\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</figure>\n\t);\n}\n","module.exports = window[\"wp\"][\"element\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"React\"];","module.exports = window[\"ReactJSXRuntime\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Frontend script for the Multi-Crypto Converter block. This file serves as the\n * entry point for rendering the React-based frontend component.\n *\n * It finds all instances of the converter block on the page and mounts the\n * `FrontendConverter` component into them, passing the selected coins as a prop.\n */\nimport { createRoot } from '@wordpress/element';\nimport FrontendConverter from './FrontendConverter';\n\n/**\n * Initialize all converter blocks on the page\n */\nfunction initializeBlocks() {\n\tconst blockWrappers = document.querySelectorAll<HTMLElement>( '.wp-block-multi-crypto-price-converter-converter' );\n\tblockWrappers.forEach( ( div ) => {\n\t\tconst coinsString = div.dataset.coins;\n\t\tif ( ! coinsString ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst coins = coinsString.split( ',' ).map( ( coin ) => coin.trim() ).filter( Boolean );\n\t\tif ( 0 === coins.length ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst container = div.querySelector( '.mcpc-converter-container' );\n\t\tif ( container ) {\n\t\t\tconst root = createRoot( container );\n\t\t\troot.render( <FrontendConverter coins={ coins } /> );\n\t\t}\n\t} );\n}\n\n// Initialize blocks on DOMContentLoaded.\nif ( document.readyState === 'loading' ) {\n\tdocument.addEventListener( 'DOMContentLoaded', initializeBlocks );\n} else {\n\tinitializeBlocks();\n}\n"],"names":["useEffect","useState","__","jsx","_jsx","jsxs","_jsxs","fetchPrices","coinsParam","signal","response","fetch","ok","Error","status","data","json","success","prices","pricesMap","forEach","item","symbol","parseFloat","price_usd","next_update","message","error","name","console","formatConvertedAmount","coin","amount","toFixed","formatPrice","price","Intl","NumberFormat","style","currency","minimumFractionDigits","maximumFractionDigits","format","FrontendConverter","coins","setPrices","baseCoin","setBaseCoin","baseAmount","setBaseAmount","isLoading","setIsLoading","setError","controller","AbortController","join","timeoutId","updatePrices","fetchedPrices","Object","keys","length","aborted","delay","nowSeconds","Date","now","diff","setTimeout","err","clearTimeout","abort","getDisplayAmount","targetCoin","usdValue","targetValue","handleRowClick","e","target","tagName","input","currentTarget","querySelector","focus","className","children","scope","onClick","id","type","value","onChange","placeholder","step","min","colSpan","map","isCurrentCoin","inputId","toUpperCase","createRoot","initializeBlocks","blockWrappers","document","querySelectorAll","div","coinsString","dataset","split","trim","filter","Boolean","container","root","render","readyState","addEventListener"],"ignoreList":[],"sourceRoot":""}